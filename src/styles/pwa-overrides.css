
/* PWA-specific CSS overrides to fix UI inconsistencies */

/* Only apply these overrides in PWA standalone mode */
@media (display-mode: standalone) {
  /* Reset body background and padding conflicts */
  body {
    background: var(--app-gradient) !important;
    background-attachment: fixed !important;
    /* Remove conflicting padding from base.css */
    padding-left: 0 !important;
    padding-right: 0 !important;
    padding-top: var(--safe-area-inset-top) !important;
    padding-bottom: var(--safe-area-inset-bottom) !important;
    /* Ensure full viewport coverage */
    min-height: 100vh !important;
    min-height: 100dvh !important;
    margin: 0 !important;
    /* Prevent white gaps */
    overflow-x: hidden !important;
  }

  /* Fix gradient background container */
  .gradient-bg {
    background: var(--app-gradient) !important;
    background-attachment: fixed !important;
    min-height: 100vh !important;
    min-height: 100dvh !important;
    /* Ensure it covers the full viewport including safe areas */
    margin: 0 !important;
    padding: 0 !important;
  }

  /* Enhanced header transparency with better backdrop */
  .border-b {
    background: rgba(255, 255, 255, 0.95) !important;
    backdrop-filter: blur(20px) saturate(180%) !important;
    -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2) !important;
  }

  /* Dark mode header adjustments */
  .dark .border-b {
    background: rgba(17, 24, 39, 0.95) !important;
    border-bottom: 1px solid rgba(55, 65, 81, 0.3) !important;
  }

  /* CRITICAL: Navigation container overflow fixes */
  nav[class*="fixed bottom-0"] {
    background: rgba(255, 255, 255, 0.98) !important;
    backdrop-filter: blur(20px) saturate(180%) !important;
    -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
    border-top: 1px solid rgba(229, 231, 235, 0.6) !important;
    
    /* Fix horizontal overflow issues */
    width: 100vw !important;
    max-width: 100vw !important;
    left: 0 !important;
    right: 0 !important;
    margin: 0 !important;
    
    /* Proper safe area handling */
    padding-left: max(env(safe-area-inset-left), 0px) !important;
    padding-right: max(env(safe-area-inset-right), 0px) !important;
    padding-bottom: max(env(safe-area-inset-bottom), 0.5rem) !important;
    height: calc(70px + env(safe-area-inset-bottom)) !important;
    
    /* Prevent content overflow */
    overflow: hidden !important;
    box-sizing: border-box !important;
  }

  /* Navigation inner container fixes */
  nav[class*="fixed bottom-0"] > div {
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 auto !important;
    box-sizing: border-box !important;
    
    /* Responsive padding adjustments */
    padding-left: max(1rem, env(safe-area-inset-left)) !important;
    padding-right: max(1rem, env(safe-area-inset-right)) !important;
    
    /* Ensure proper flex distribution */
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    gap: 0.25rem !important;
  }

  /* Navigation buttons responsive sizing */
  nav[class*="fixed bottom-0"] button {
    flex: 1 1 auto !important;
    min-width: 0 !important;
    max-width: none !important;
    padding-left: 0.5rem !important;
    padding-right: 0.5rem !important;
    
    /* Prevent text overflow */
    overflow: hidden !important;
  }

  /* Navigation button text truncation */
  nav[class*="fixed bottom-0"] button span {
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    max-width: 100% !important;
  }

  /* Dark mode navigation adjustments */
  .dark nav[class*="fixed bottom-0"] {
    background: rgba(17, 24, 39, 0.98) !important;
    border-top: 1px solid rgba(55, 65, 81, 0.6) !important;
  }

  /* Content container adjustments for PWA */
  .content-container,
  .mobile-safe-bottom {
    /* Remove double safe area padding */
    padding-bottom: calc(70px + env(safe-area-inset-bottom)) !important;
  }

  /* Main content areas should not have background conflicts */
  main {
    background: transparent !important;
  }

  /* Prevent white flashes on page transitions */
  .min-h-screen,
  .min-h-dvh {
    background: transparent !important;
  }

  /* Fix any cards or components that might show white backgrounds */
  .bg-gray-50 {
    background: rgba(249, 250, 251, 0.95) !important;
  }

  .dark .bg-gray-900 {
    background: rgba(17, 24, 39, 0.95) !important;
  }

  /* Enhance safe area handling for top notch */
  .safe-top,
  .modal-safe-top {
    padding-top: max(var(--safe-area-inset-top), 1rem) !important;
  }

  /* Top notch background enhancement */
  .fixed.top-0[class*="z-40"] {
    background: var(--header-background) !important;
    backdrop-filter: blur(20px) saturate(180%) !important;
    -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
  }
}

/* iOS-specific PWA enhancements */
@supports (-webkit-touch-callout: none) {
  @media (display-mode: standalone) {
    /* iOS Safari PWA specific fixes */
    body {
      /* Enhanced iOS background handling */
      background: var(--app-gradient) !important;
      background-attachment: fixed !important;
      /* iOS viewport fix */
      min-height: -webkit-fill-available !important;
    }

    /* iOS navigation overflow fixes */
    nav[class*="fixed bottom-0"] {
      /* Enhanced iOS safe area integration */
      padding-left: max(env(safe-area-inset-left), 0.75rem) !important;
      padding-right: max(env(safe-area-inset-right), 0.75rem) !important;
      
      /* iOS-specific width constraints */
      width: 100vw !important;
      max-width: 100vw !important;
      min-width: 100vw !important;
      
      /* Prevent iOS Safari zoom issues */
      -webkit-text-size-adjust: 100% !important;
      text-size-adjust: 100% !important;
    }

    /* iOS navigation inner container */
    nav[class*="fixed bottom-0"] > div {
      /* iOS-optimized padding */
      padding-left: max(0.5rem, env(safe-area-inset-left) / 2) !important;
      padding-right: max(0.5rem, env(safe-area-inset-right) / 2) !important;
      
      /* Tighter gap for iOS */
      gap: 0.125rem !important;
    }

    /* iOS button optimizations */
    nav[class*="fixed bottom-0"] button {
      /* Smaller padding on iOS for better fit */
      padding-left: 0.25rem !important;
      padding-right: 0.25rem !important;
      
      /* iOS touch target optimization */
      min-height: 44px !important;
    }

    /* iOS safe area enhancements */
    .modal-close-safe {
      top: max(var(--safe-area-inset-top, 0px) + 1.25rem, 1.25rem) !important;
      right: max(var(--safe-area-inset-right, 0px) + 1rem, 1rem) !important;
    }

    /* iOS Dynamic Island handling for newer devices */
    @media (max-height: 926px) and (min-height: 844px) {
      .modal-close-safe {
        top: max(var(--safe-area-inset-top, 0px) + 1.5rem, 1.5rem) !important;
      }
      
      .modal-safe-top {
        padding-top: max(var(--safe-area-inset-top, 0px) + 2rem, 2rem) !important;
      }
      
      /* Enhanced navigation for Dynamic Island devices */
      nav[class*="fixed bottom-0"] {
        padding-left: max(env(safe-area-inset-left), 1rem) !important;
        padding-right: max(env(safe-area-inset-right), 1rem) !important;
      }
    }
  }
}

/* Android PWA specific fixes */
@media (display-mode: standalone) and (max-width: 768px) {
  /* Android Chrome PWA enhancements */
  body {
    /* Prevent address bar appearance */
    overscroll-behavior-y: contain !important;
    /* Enhanced scroll performance */
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Android navigation optimizations */
  nav[class*="fixed bottom-0"] {
    /* Android-specific safe area handling */
    padding-left: max(env(safe-area-inset-left), 0.5rem) !important;
    padding-right: max(env(safe-area-inset-right), 0.5rem) !important;
  }
}

/* Small screen optimizations for navigation overflow */
@media (display-mode: standalone) and (max-width: 320px) {
  nav[class*="fixed bottom-0"] {
    /* Ultra-compact padding for very small screens */
    padding-left: max(env(safe-area-inset-left), 0.25rem) !important;
    padding-right: max(env(safe-area-inset-right), 0.25rem) !important;
  }
  
  nav[class*="fixed bottom-0"] > div {
    padding-left: 0.125rem !important;
    padding-right: 0.125rem !important;
    gap: 0.0625rem !important;
  }
  
  nav[class*="fixed bottom-0"] button {
    padding-left: 0.125rem !important;
    padding-right: 0.125rem !important;
    font-size: 0.6875rem !important;
  }
  
  nav[class*="fixed bottom-0"] button span {
    font-size: 0.625rem !important;
  }
}

/* Medium screen optimizations */
@media (display-mode: standalone) and (min-width: 321px) and (max-width: 480px) {
  nav[class*="fixed bottom-0"] > div {
    padding-left: max(0.75rem, env(safe-area-inset-left)) !important;
    padding-right: max(0.75rem, env(safe-area-inset-right)) !important;
    gap: 0.375rem !important;
  }
  
  nav[class*="fixed bottom-0"] button {
    padding-left: 0.375rem !important;
    padding-right: 0.375rem !important;
  }
}

/* Large screen optimizations */
@media (display-mode: standalone) and (min-width: 481px) {
  nav[class*="fixed bottom-0"] > div {
    max-width: 480px !important;
    padding-left: max(1.5rem, env(safe-area-inset-left)) !important;
    padding-right: max(1.5rem, env(safe-area-inset-right)) !important;
    gap: 0.75rem !important;
  }
  
  nav[class*="fixed bottom-0"] button {
    padding-left: 0.75rem !important;
    padding-right: 0.75rem !important;
  }
}
